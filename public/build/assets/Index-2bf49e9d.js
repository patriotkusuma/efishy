import{r,W as F,j as o,a as t,b as I,g as O}from"./app-ae6dc9df.js";import"./index-7b77cee7.js";import{u as E,A as N}from"./AuthenticatedLayout-dc541615.js";import"./TablePh-0644b85b.js";import{O as q,a as A}from"./OverviewPakanTerakhir-48f760fa.js";import{C as G,T as H}from"./TableTempatPakan-c3197c4f.js";import{h as C}from"./moment-fbc5633a.js";import{S as V}from"./SearchRiwayatPakan-f9c8fa09.js";import{C as J}from"./Container-be20f32f.js";import{S as x,C as Q,a as W}from"./Stack-84c66384.js";import{G as d}from"./index.esm-04eca18b.js";import{C as z}from"./CardContent-c756119f.js";import"./transition-c030e732.js";import"./DatePicker-a8dcfccd.js";import"./styled-b627da4d.js";import"./Button-7259bb28.js";import"./IconButton-78b9cee9.js";import"./TextField-f735f57a.js";import"./DemoContainer-5c8171cb.js";import"./useMediaQuery-5c17f929.js";import"./index.esm-e5efdc73.js";import"./Hidden-a2631a2e.js";import"./Box-4b033169.js";import"./react-apexcharts.min-359bcf8e.js";import"./TableContainer-8af6b93b.js";function Ca(T){const u=E(),{auth:v,pakanTerakhir:g,chartSisaPakan:n,sisaPakans:f}=T,[B,k]=r.useState(),[P,S]=r.useState(0);F();const[c,p]=r.useState(0),[D,M]=r.useState(5),[i,b]=r.useState(null),[s,w]=r.useState(null),[l,Y]=r.useState(null),[y,K]=r.useState(()=>{if(n){var a=[];return n.map(e=>{a.push(e.tinggi_pakan)}),a}else return null}),[R,L]=r.useState(()=>{if(n){var a=[];return n.map(e=>{a.push(C(e.created_at).format("DD MMMM"))}),a}else return null}),h=(a=null,e=null)=>{O.get(route("pakan.sisa-pakan.index"),{page:e||c,rowsPerPage:a||D,searchData:i||"",dateFrom:s?s.format("YYYY-MM-DD"):"",dateTo:l?l.format("YYYY-MM-DD"):""},{preserveScroll:!0,preserveState:!0,replace:!0,only:["sisaPakans"]})};r.useEffect(()=>{if(u.connect("wss://mqtt.efishy.my.id:8083/",{keepalive:60}),u.subscribe(["realTime"],0,{},()=>{console.log("subscribed RealTime"),S(n[0].tinggi_pakan)}),i!=null||s||l){console.log(s),p(0);let a=c+1;h(null,a)}},[i,s,l,""]),u.registerEvent("realTime",(a,e)=>{var m=JSON.parse(e);m==0?k(!1):(k(!0),S(m.valueSisaPakan),console.log(m.valueSisaPakan))});const j=(a,e)=>{p(e);let m=e+1;h(null,m)},_=a=>{M(+a.target.value),p(0);let e=c+1;h(a.target.value,e)};return o(N,{user:v.user,header:t("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Informasi Tempat Pakan"}),children:[t(I,{title:"Infomasi Tempat Pakan"}),t(J,{className:"py-12",children:o(x,{spacing:3,children:[o(d,{container:!0,spacing:3,sx:{flexDirection:{xs:"column",md:"row"}},justifyContent:"space-between",children:[t(d,{item:!0,xs:"auto",md:"auto",children:o(x,{spacing:2,direction:"column",alignItems:"stretch",children:[t(q,{customColor:"#fbc02d",sx:{height:"100%",borderRadius:"10px"},value:P||0}),t(A,{customColor:"#fbc02d",sx:{height:"100%",borderRadius:"10px"},value:g.jumlah_keluar,time:C(g.created_at).format("DD MMMM YYYY")})]})}),t(d,{item:!0,xs:"auto",md:8,children:t(G,{dateChart:R,chartSeries:[{name:"Sisa Pakan",data:y}],sx:{width:1}})})]}),o(Q,{children:[t(W,{title:"Riwayat Tempat Pakan"}),o(z,{children:[t(V,{searchData:i,dateFrom:s,dateTo:l,onDateFrom:a=>w(a),onDateTo:a=>Y(a),onSearchData:({target:a})=>b(a.value)}),t(H,{count:f.total,page:c,rowsPerPage:D,items:f.data,onPageChange:j,onRowsPerPageChange:_})]})]})]})})]})}export{Ca as default};
