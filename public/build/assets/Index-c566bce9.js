import{j as r,a as e,q as ee,r as o,W as te,g as I,b as ae}from"./app-ae6dc9df.js";import"./ChartPh-c5ba6988.js";import{P as a,C as re}from"./Container-be20f32f.js";import{_ as oe}from"./react-apexcharts.min-359bcf8e.js";import{h as se}from"./moment-fbc5633a.js";import{C as E,a as N,S as T}from"./Stack-84c66384.js";import{C as W}from"./CardContent-c756119f.js";import{i as ne,T as b}from"./Button-7259bb28.js";import{O as ie}from"./OverviewSuhu-0c791957.js";import{h as ue,D as R,T as le,a as ce,b as A,c as f,d as he,f as me}from"./DatePicker-a8dcfccd.js";import{I as de,L as _,A as H,D as q}from"./DemoContainer-5c8171cb.js";import{a as pe}from"./index.esm-497e4627.js";import{y as M,I as z}from"./index.esm-e5efdc73.js";import{G as S,F as ge,I as fe,O as Se}from"./TextField-f735f57a.js";import{B as xe}from"./Box-4b033169.js";import{g as L,b as V,r as O,f as y}from"./styled-b627da4d.js";import{u as De,A as Ce}from"./AuthenticatedLayout-dc541615.js";import"./index-7b77cee7.js";import"./IconButton-78b9cee9.js";import"./useMediaQuery-5c17f929.js";import"./transition-c030e732.js";const Ye=p=>{const c=ne();return{chart:{background:"transparent",stacked:!1,toolbar:{show:!0,tools:{download:!0,selection:!1,zoom:!1,zoomin:!0,zoomout:!0,pan:!0}}},colors:[c.palette.warning.light,c.palette.error.light],dataLabels:{enabled:!0},stroke:{curve:"smooth",width:[4,4]},plotOptions:{area:{fillTo:"origin"}},xaxis:{categories:p},yaxis:[{axisTicks:{show:!0},axisBorder:{show:!0,color:"#FF1654"},labels:{style:{colors:"#FF1654"}},title:{text:"Suhu Minimum",style:{color:"#FF1654"}}},{opposite:!0,axisTicks:{show:!0},axisBorder:{show:!0,color:"#247BA0"},labels:{style:{colors:"#247BA0"}},title:{text:"Suhu Maksimum",style:{color:"#247BA0"}}}],tooltip:{shared:!1,intersect:!0,x:{show:!1}},legend:{horizontalAlign:"left",offsetX:0}}},G=p=>{const{chartSeries:c,sx:x,dateChart:l}=p,h=Ye(l);return r(E,{sx:x,children:[e(N,{title:"Suhu 30 Hari Terakhir"}),e(W,{children:e(oe,{height:300,options:h,series:c,type:"line",width:"100%"})})]})};G.prototype={chartSeries:a.array.isRequired,sx:a.object,dateChart:a.array.isRequired};const J=p=>{const{count:c=0,items:x=[],onPageChange:l,onRowsPerPageChange:h,page:C,rowsPerPage:Y,searchSuhu:g,dateFrom:s,dateTo:v,onSearchSuhu:n,onDateFromSearch:w,onDateToSearch:i}=p;return r(E,{children:[e(N,{title:"Data Suhu"}),e(W,{children:r(T,{spacing:2,children:[r(S,{container:!0,spacing:2,direction:{xs:"column",md:"row"},alignItems:"stretch",justifyContent:"center",children:[e(S,{item:!0,xs:6,children:r(ge,{fullWidth:!0,sx:{m:1},variant:"outlined",children:[e(fe,{htmlFor:"outlined-adorment-search",children:"Cari"}),e(Se,{id:"outlined-adorment-search",type:"text",value:g,onChange:n,startAdornment:e(de,{position:"start",children:e(ue,{})})})]})}),e(S,{item:!0,xs:3,children:e(_,{dateAdapter:H,children:e(q,{components:["DatePicker"],children:e(R,{componentsProps:{actionBar:{actions:["cancel","clear","accept"]}},value:s,onAccept:w,format:"DD MMMM YYYY",label:"Dari tanggal"})})})}),e(S,{item:!0,xs:3,children:e(_,{dateAdapter:H,children:e(q,{components:["DatePicker"],children:e(R,{componentsProps:{actionBar:{actions:["cancel","clear","accept"]}},value:v,onAccept:i,label:"Sampai tanggal",minDate:s,format:"DD MMMM YYYY"})})})})]}),e(xe,{children:r(le,{children:[e(ce,{children:r(A,{children:[e(f,{children:"No"}),e(f,{children:"Suhu"}),e(f,{children:"Waktu"})]})}),e(he,{children:x.length==0?e(A,{style:{backgroundColor:L[200]},children:e(f,{colSpan:3,align:"center",children:r(T,{direction:"row",alignItems:"center",justifyContent:"center",spacing:2,children:[e(b,{color:M[900],variant:"h5",component:"h6",children:e(z,{})}),e(b,{color:L[900],variant:"h6",component:"h6",children:"Data Tidak Ditemukan"}),e(b,{color:M[900],variant:"h5",component:"h6",children:e(z,{})})]})})}):x.map((m,D)=>{var d=V[500];return m.status_suhu>32&&(d=O[500]),m.status_suhu<26&&(d=V[500]),m.status_suhu>26&&m.status_suhu<32&&(d=y[500]),r(A,{hover:!0,children:[e(f,{children:(C-1)*Y+D+Y+1}),e(f,{children:r(T,{direction:"row",alignItems:"center",spacing:2,children:[e(b,{variant:"h5",color:d,children:e(pe,{color:d})}),r(b,{variant:"h6",children:[e("b",{children:m.status_suhu+" "}),"Ph"]})]})}),e(f,{children:se(m.created_at).format("HH:mm:ss, DD MMMM YYYY")})]},m.id)})})]})}),e(me,{component:"div",count:c,onPageChange:l,onRowsPerPageChange:h,page:C,rowsPerPage:Y,rowsPerPageOptions:[5,10,25]})]})})]})};J.prototype={count:a.number,items:a.array,onPageChange:a.func,onRowsPerPageChange:a.func,page:a.number,rowsPerPage:a.number,searchSuhu:a.string,dateFrom:a.any,dateTo:a.any,onSearchSuhu:a.func,onDateFromSearch:a.func,onDateToSearch:a.func};const B=()=>({preserveState:!0,preserveScroll:!0,replace:!0,only:["suhus"]}),Je=()=>{const{auth:p,suhus:c,lastSuhu:x,maxChartSuhu:l}=ee().props,[h,C]=o.useState(0),[Y,g]=o.useState(y[500]),[s,v]=o.useState(null),[n,w]=o.useState(null),[i,m]=o.useState(null),[D,d]=o.useState(0),[k,K]=o.useState(5),[Q,be]=o.useState(()=>{if(l){var t=[];return l.map(u=>{t.push(u.max)}),t}}),[X,Pe]=o.useState(()=>{if(l){var t=[];return l.map(u=>{t.push(u.min)}),t}}),[U,Te]=o.useState(()=>{if(l){var t=[];return l.map(u=>{t.push(u.date)}),t}}),F=De(),[ye,j]=o.useState();te(),o.useEffect(()=>{F.connect("wss://mqtt.efishy.my.id:8083/",{keepalive:60}),F.subscribe(["realTime"],0,{},()=>{console.log("subscribed RealTime"),C(x.status_suhu)})},[]),F.registerEvent("realTime",(t,u)=>{var P=JSON.parse(u);P==0?(j(!1),console.log("message 0"),h>32?g(O[500]):h<26?g(M[700]):g(y[500])):(j(!0),C(P.valuesSuhu),h>32?g(O[500]):h<26?g(M[700]):g(y[500]))}),o.useEffect(()=>{if(s!=null||n!=null||i!=null){d(0);let t=D+1;I.get(route("kualitas-air.suhu.index"),{page:t,searchSuhu:s||"",rowsPerPage:k,dateFrom:n?n.format("DD-MM-YYYY"):"",dateTo:i?i.format("DD-MM-YYYY"):""},B())}},[s,n,i]);const Z=(t,u)=>{d(u);let P=D+1;I.get(route("kualitas-air.suhu.index"),{page:P,searchSuhu:s||"",rowsPerPage:k,dateFrom:n?n.format("DD-MM-YYYY"):"",dateTo:i?i.format("DD-MM-YYYY"):""},B())},$=t=>{K(+t.target.value),d(0);let u=D+1;I.get(route("kualitas-air.suhu.index"),{page:u,searchSuhu:s||"",rowsPerPage:t.target.value,dateFrom:n?n.format("DD-MM-YYYY"):"",dateTo:i?i.format("DD-MM-YYYY"):""},B())};return r(Ce,{user:p.user,header:e("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Informasi Suhu Kolam"}),children:[e(ae,{title:"Informasi Suhu"}),e(re,{className:"py-12",children:r(T,{spacing:2,justifyContent:"space-between",direction:"column",children:[r(S,{container:!0,spacing:2,sx:{flexDirection:{xs:"column",md:"row"}},alignItems:{xs:"stretch",md:"flex-start"},justifyContent:"space-between",children:[e(S,{item:!0,xs:12,md:3,children:e(ie,{suhuColors:Y,sx:{height:"100%",borderRadius:"10px"},value:h.toLocaleString("id-ID",{maximumFractionDigits:2})})}),e(S,{item:!0,xs:12,md:9,children:e(G,{dateChart:U,chartSeries:[{name:"Suhu Minimum",data:X},{name:"Suhu Maksimum",data:Q}],sx:{height:"100%"}})})]}),e(J,{items:c.data,count:c.total,page:D,onPageChange:Z,onRowsPerPageChange:$,rowsPerPage:k,searchSuhu:s,onSearchSuhu:({target:t})=>v(t.value),onDateFromSearch:t=>w(t),dateFrom:n,dateTo:i,onDateToSearch:t=>m(t)})]})})]})};export{Je as default};
