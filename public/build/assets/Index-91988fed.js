import{r as t,q as R,W as q,g as d,j as f,a as i,b as N}from"./app-ae6dc9df.js";import{u as G,A as H}from"./AuthenticatedLayout-dc541615.js";import"./index-7b77cee7.js";import{T as J}from"./TablePh-0644b85b.js";import{O as Q}from"./OverviewPh-4372f450.js";import{C as W}from"./ChartPh-c5ba6988.js";import"./DemoContainer-5c8171cb.js";import{f as P,b as v,r as C}from"./styled-b627da4d.js";import{C as _}from"./Container-be20f32f.js";import{S as z}from"./Stack-84c66384.js";import{G as Y}from"./index.esm-04eca18b.js";import"./transition-c030e732.js";import"./DatePicker-a8dcfccd.js";import"./Button-7259bb28.js";import"./IconButton-78b9cee9.js";import"./TextField-f735f57a.js";import"./useMediaQuery-5c17f929.js";import"./moment-fbc5633a.js";import"./index.esm-e5efdc73.js";import"./CardContent-c756119f.js";import"./Hidden-a2631a2e.js";import"./Box-4b033169.js";import"./react-apexcharts.min-359bcf8e.js";const x=()=>({preserveState:!0,preserveScroll:!0,replace:!0,only:["phValues"]});function Me(){const c=G(),[B,M]=t.useState(),{auth:T,phValues:S,lastPh:b,chartPh:l}=R().props,[n,D]=t.useState(0),[w,u]=t.useState(P[500]),[h,g]=t.useState(0),[m,V]=t.useState(5),[a,k]=t.useState(null),[r,F]=t.useState(null),[s,y]=t.useState(null);q(),h&&h+1,r&&r.format("YYYY-MM-DD"),s&&s.format("YYYY-MM-DD");const[I,K]=t.useState(()=>{if(l){var e=[];return l.map(o=>{e.push(o.max)}),e}}),[j,L]=t.useState(()=>{if(l){var e=[];return l.map(o=>{e.push(o.min)}),e}}),[A,U]=t.useState(()=>{if(l){var e=[];return l.map(o=>{e.push(o.date)}),e}});t.useEffect(()=>{c.connect("wss://mqtt.efishy.my.id:8083/",{keepalive:60}),c.subscribe(["realTime"],0,{},()=>{console.log("subscribed RealTime"),D(b.status_ph)}),c.registerEvent("realTime",(e,o)=>{var p=JSON.parse(o);p==0?(M(!1),n>8?u(v[500]):n<6||n==0?u(C[500]):u(P[500])):(M(!0),D(p.valuesPh),n>8?u(v[500]):n<6||n==0?u(C[500]):u(P[500]))})},[]),t.useEffect(()=>{if(a!=null||r!=null||s!=null){g(0);let e=h+1;d.get(route("kualitas-air.sensor-ph.index"),{page:e||0,searchPh:a||"",rowsPerPage:m||5,dateFrom:r?r.format("YYYY-MM-DD"):"",dateTo:s?s.format("YYYY-MM-DD"):""},x())}},[a,r,s]);const E=(e,o)=>{g(o);let p=h+1;d.get(route("kualitas-air.sensor-ph.index"),{page:p||0,searchPh:a||"",rowsPerPage:m||5,dateFrom:r?r.format("YYYY-MM-DD"):"",dateTo:s?s.format("YYYY-MM-DD"):""},x())},O=e=>{V(+e.target.value),g(0);let o=h+1;d.get(route("kualitas-air.sensor-ph.index"),{page:o,searchPh:a||"",rowsPerPage:e.target.value,dateFrom:r?r.format("YYYY-MM-DD"):"",dateTo:s?s.format("YYYY-MM-DD"):""},x())};return f(H,{user:T.user,header:i("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Informasi Ph Air"}),children:[i(N,{title:"Infomasi Ph Air"}),i(_,{className:"py-12",children:f(z,{spacing:2,children:[f(Y,{container:!0,spacing:3,alignItems:{xs:"stretch",md:"flex-start"},direction:{xs:"column",md:"row"},alignItems:"flex-start",justifyContent:"space-between",children:[i(Y,{items:!0,xs:12,md:3,alignItems:"center",alignContent:"center",children:i(Q,{phColors:w,sx:{height:"100%",borderRadius:"10px"},value:n})}),i(Y,{items:!0,xs:12,md:9,children:i(W,{dateChart:A,chartSeries:[{name:"Ph Minimum",data:j},{name:"Ph Maksimum",data:I}],sx:{height:"100%"}})})]}),i(J,{items:S.data,count:S.total,rowsPerPage:m,page:h,onRowsPerPageChange:O,onPageChange:E,searchPh:a,onSearchPh:({target:e})=>k(e.value),dateFrom:r,onDateFromSearch:e=>F(e),dateTo:s,onDateToSearch:e=>y(e)})]})})]})}export{Me as default};
